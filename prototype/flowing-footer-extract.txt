<!-- ===== FLOWING MVP FOOTER (Fixed at bottom) ===== -->
  <div id="flowingFooter" class="flowing-footer collapsed">
    <!-- Toggle Button -->
    <button id="flowingToggleBtn" class="flowing-toggle-btn" title="Flowing MVP Assistant">
      <span class="flowing-icon flowing-sf-logo">SF</span>
      <div class="flowing-info">
        <span class="flowing-label">Flowing MVP</span>
        <span class="flowing-suggestion" id="flowingSuggestion">Analyzing your queue...</span>
      </div>
      <span class="flowing-chevron">â–²</span>
    </button>

    <!-- Flowing Content -->
    <div class="flowing-content">
      <div class="flowing-header">
        <div class="flowing-title">
          <span class="flowing-avatar flowing-sf-logo">SF</span>
          <div class="flowing-title-text">
            <h3>Flowing MVP</h3>
            <p class="flowing-subtitle">Your AI assistant for tickets, SLAs, and smart suggestions</p>
          </div>
        </div>
        <button id="flowingCloseBtn" class="flowing-close-btn" title="Close">âœ•</button>
      </div>

      <!-- Messages Container -->
      <div id="flowingMessages" class="flowing-messages">
        <div class="flowing-message assistant">
          <div class="message-avatar flowing-sf-logo">SF</div>
          <div class="message-content">
            <p>ðŸ‘‹ Hi! I'm Flowing MVP, your SpeedyFlow Ticket Solving Mate! I can help you with:</p>
            <ul>
              <li>ðŸ“‹ Analyzing ticket priorities and patterns</li>
              <li>â±ï¸ Explaining SLA statuses and deadlines</li>
              <li>ðŸŽ¯ Suggesting next actions for tickets</li>
              <li>ðŸ“Š Providing insights on queue metrics</li>
            </ul>
            <p>Just ask me anything!</p>
          </div>
        </div>
      </div>

      <!-- Input Area -->
      <div class="flowing-input-area">
        <div class="flowing-context-badge" id="flowingContextBadge">
          <span class="context-icon">ðŸ“Œ</span>
          <span class="context-text">No context</span>
        </div>
        <div class="flowing-input-wrapper">
          <textarea 
            id="flowingInput" 
            class="flowing-input" 
            placeholder="Ask me anything about your tickets..."
            rows="1"
          ></textarea>
          <button id="flowingSendBtn" class="flowing-send-btn" title="Send message">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== ML PREDICTIVE DASHBOARD MODAL ===== -->
  <div id="ml-dashboard-modal" class="ml-dashboard-modal">
    <div class="ml-dashboard-container">
      <!-- Header -->
      <div class="ml-dashboard-header">
        <div class="ml-dashboard-title">
          <h2>ðŸŽ¯ ML Predictive Dashboard</h2>
          <div class="ml-dashboard-subtitle">Real-time insights powered by Machine Learning</div>
          <div class="ml-dashboard-data-source" id="ml-data-source-indicator">
            <span class="data-source-icon">ðŸ“Š</span>
            <span class="data-source-text">Loading...</span>
          </div>
        </div>
        <div class="ml-dashboard-controls">
          <button class="ml-dashboard-refresh" title="Refresh data">
            ðŸ”„ Refresh
          </button>
          <div class="ml-dashboard-auto-refresh-toggle">
            <input type="checkbox" id="ml-dashboard-auto-refresh" checked />
            <label for="ml-dashboard-auto-refresh">Auto-refresh</label>
          </div>
          <button class="ml-dashboard-close">âœ• Close</button>
        </div>
      </div>

      <!-- Tab Navigation -->
      <div class="ml-dashboard-tabs">
        <button class="ml-dashboard-tab active" data-tab="overview"><span class="ml-tab-icon" id="icon-ml-overview"></span> Overview</button>
        <button class="ml-dashboard-tab" data-tab="forecast"><span class="ml-tab-icon" id="icon-ml-forecast"></span> Breach Forecast</button>
        <button class="ml-dashboard-tab" data-tab="trends"><span class="ml-tab-icon" id="icon-ml-trends"></span> Performance</button>
        <button class="ml-dashboard-tab" data-tab="team"><span class="ml-tab-icon" id="icon-ml-team"></span> Team Workload</button>
      </div>

      <!-- Content -->
      <div class="ml-dashboard-content">
        <!-- Overview Tab -->
        <div class="ml-dashboard-tab-content active" data-tab="overview">
          <div class="metrics-grid">
            <div class="metric-card" data-metric="total-tickets">
              <span class="metric-value">-</span>
              <span class="metric-label">Total Tickets</span>
            </div>
            <div class="metric-card" data-metric="critical-tickets">
              <span class="metric-value">-</span>
              <span class="metric-label">Critical</span>
            </div>
            <div class="metric-card" data-metric="sla-compliance">
              <span class="metric-value">-</span>
              <span class="metric-label">SLA Compliance</span>
            </div>
            <div class="metric-card" data-metric="at-risk-tickets">
              <span class="metric-value">-</span>
              <span class="metric-label">At Risk</span>
            </div>
          </div>

          <div class="charts-grid">
            <div class="chart-container">
              <canvas id="sla-breakdown-chart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="priority-distribution-chart"></canvas>
            </div>
          </div>

          <h3 style="color: #f3f4f6; margin: 30px 0 15px;">âš ï¸ High-Risk Tickets</h3>
          <div id="breach-predictions-list"></div>
        </div>

        <!-- Breach Forecast Tab -->
        <div class="ml-dashboard-tab-content" data-tab="forecast">
          <div id="breach-forecast-content">
            <div class="ml-dashboard-loader">
              <div class="loader-spinner"></div>
              <div class="loader-text">Loading forecast...</div>
            </div>
          </div>
        </div>

        <!-- Performance Trends Tab -->
        <div class="ml-dashboard-tab-content" data-tab="trends">
          <div class="charts-grid">
            <div class="chart-container">
              <canvas id="ticket-volume-chart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="sla-compliance-chart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="resolution-time-chart"></canvas>
            </div>
          </div>
        </div>

        <!-- Team Workload Tab -->
        <div class="ml-dashboard-tab-content" data-tab="team">
          <div id="team-workload-content">
            <div class="ml-dashboard-loader">
              <div class="loader-spinner"></div>
              <div class="loader-text">Loading team data...</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Loader Overlay -->
      <div class="ml-dashboard-loader">
        <div class="loader-spinner"></div>
        <div class="loader-text" id="ml-loader-text">Loading dashboard...</div>
        <div class="loader-progress-container">
          <div class="loader-progress-bar" id="ml-loader-progress-bar"></div>
        </div>
        <div class="loader-percentage" id="ml-loader-percentage">0%</div>
      </div>
    </div>
  </div>

  <script>
    // Detectar usuario actual desde JIRA
    fetch('/api/user')
      .then(r => r.json())
      .then(data => {
        const user = data.displayName || data.name || 'You';
        localStorage.setItem('currentUser', user);
        localStorage.setItem('userFullName', data.displayName || 'John Doe');
        localStorage.setItem('userEmail', data.emailAddress || 'user@example.com');
      })
      .catch(() => {
        localStorage.setItem('currentUser', 'You');
        localStorage.setItem('userFullName', 'John Doe');
        localStorage.setItem('userEmail', 'user@example.com');
      });
  </script>
  
  <!-- ===== CORE APPLICATION SCRIPTS ===== -->
  <!-- Constants & Configuration (MUST load first) -->
  <script src="/static/js/constants/card-sizing.js"></script>
  
  <!-- SVG Icons Module - Centralized icon library -->
  <script src="/static/js/utils/svg-icons.js?v={{ timestamp }}"></script>
  
  <!-- Theme Manager - Centralized theme control -->
  <script src="/static/js/theme-manager.js?v={{ timestamp }}"></script>
  <script src="/static/js/sidebar-toggle.js?v={{ timestamp }}"></script>
  <script src="/static/js/sidebar-tooltip-manager.js?v={{ timestamp }}"></script>
  <script src="/static/js/modules/sidebar-actions.js?v={{ timestamp }}"></script>
  <script src="/static/js/header-menu-controller.js?v={{ timestamp }}"></script>
  <script src="/static/js/right-sidebar.js?v={{ timestamp }}"></script>
  <script src="/static/js/mentions-system.js?v={{ timestamp }}"></script>
  <script src="/static/js/notifications-panel.js?v={{ timestamp }}"></script>
  <script src="/static/js/sla-monitor.js?v={{ timestamp }}"></script>
  
  <!-- ===== GLASSMORPHISM & TRANSPARENCY ===== -->
  <script src="/static/js/glassmorphism-opacity-controller.js?v={{ timestamp }}"></script>
  
  <!-- ===== BACKGROUND & AI EFFECTS ===== -->
  <script src="/static/js/background-manager.js?v={{ timestamp }}"></script>
  <script src="/static/js/background-selector-ui.js?v={{ timestamp }}"></script>
  
  <!-- ===== UI ENHANCEMENTS ===== -->
  <script src="/static/js/app.js?v={{ timestamp }}"></script>
  <script src="/static/js/auto-severity-config.js?v={{ timestamp }}"></script>
  <script src="/static/js/filter-bar-manager.js?v={{ timestamp }}"></script>
  <script src="/static/js/loading-state-manager.js?v={{ timestamp }}"></script>
  <script src="/static/js/loading-dots.js?v={{ timestamp }}"></script>

  <!-- ===== AI & ML MODULES ===== -->
  <script src="/static/js/modules/ai-queue-analyzer.js?v={{ timestamp }}"></script>
  <script src="/static/js/modules/view-toggle-filters.js?v={{ timestamp }}"></script>
  <script src="/static/js/modules/ai-field-suggestions.js?v={{ timestamp }}"></script>
  <script src="/static/js/modules/sidebar-inline-editor.js?v={{ timestamp }}"></script>
  <script src="/static/js/modules/ml-comment-suggestions.js?v={{ timestamp }}"></script>
  <script src="/static/js/modules/ml-anomaly-dashboard.js?v={{ timestamp }}"></script>

  <!-- ===== DRAG & DROP TRANSITIONS ===== -->
  <script src="/static/views/board/drag-transition-vertical.js?v={{ timestamp }}"></script>
  <script src="/static/views/list/list-view-transitions.js?v={{ timestamp }}"></script>
  
  <!-- ===== QUICK ACTIONS (Quick Triage & Smart Filters) ===== -->
  <script src="/static/js/quick-triage.js?v={{ timestamp }}"></script>
  <script src="/static/js/smart-filters.js?v={{ timestamp }}"></script>
  <script src="/static/js/smart-functions-modal.js?v={{ timestamp }}"></script>
  <script src="/static/js/smart-analytics.js?v={{ timestamp }}"></script>

  
