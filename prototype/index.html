<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flowing MVP v2.0 - Prototype</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <h1><i class="fas fa-rocket"></i> SPEEDYFLOW Flowing MVP v2.0</h1>
            <span class="badge badge-beta">Prototype</span>
        </div>
        <div class="header-right">
            <button class="btn-icon" id="notificationsBtn">
                <i class="fas fa-bell"></i>
                <span class="notification-dot"></span>
            </button>
            <button class="btn-icon" id="settingsBtn">
                <i class="fas fa-cog"></i>
            </button>
        </div>
    </header>

    <!-- Main Container: 2 columnas -->
    <div class="main-container">
        <!-- COLUMNA IZQUIERDA: Chat + ML Assistant -->
        <div class="left-column">
            <!-- Tabs -->
            <div class="column-tabs">
                <button class="tab-btn active" data-tab="chat">
                    <i class="fas fa-comments"></i> Chat
                </button>
                <button class="tab-btn" data-tab="ml">
                    <i class="fas fa-brain"></i> ML Assistant
                </button>
                <button class="tab-btn" data-tab="history">
                    <i class="fas fa-history"></i> History
                </button>
            </div>

            <!-- Tab: Chat -->
            <div class="tab-content active" id="chat-tab">
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <!-- Mensajes del chat -->
                        <div class="message system">
                            <div class="message-content">
                                <i class="fas fa-robot"></i>
                                <p>¡Hola! Soy tu asistente IA. ¿En qué puedo ayudarte con este ticket?</p>
                            </div>
                        </div>
                    </div>

                    <div class="chat-input-container">
                        <div class="quick-actions-bar">
                            <button class="quick-action-btn" data-action="suggest-comment">
                                <i class="fas fa-comment-dots"></i> Sugerir Comentario
                            </button>
                            <button class="quick-action-btn" data-action="summarize">
                                <i class="fas fa-compress-alt"></i> Resumir
                            </button>
                            <button class="quick-action-btn" data-action="translate">
                                <i class="fas fa-language"></i> Traducir
                            </button>
                        </div>
                        
                        <div class="chat-input-wrapper">
                            <textarea 
                                id="chatInput" 
                                placeholder="Escribe tu mensaje o pregunta..."
                                rows="3"
                            ></textarea>
                            <button class="btn-send" id="sendBtn">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab: ML Assistant -->
            <div class="tab-content" id="ml-tab">
                <div class="ml-assistant-container">
                    <h3><i class="fas fa-brain"></i> ML Predictions</h3>
                    
                    <!-- ML Status -->
                    <div class="ml-status" id="mlStatus">
                        <div class="status-indicator">
                            <span class="status-dot"></span>
                            <span>Conectando con ML Service...</span>
                        </div>
                    </div>

                    <!-- ML Actions -->
                    <div class="ml-actions">
                        <button class="ml-action-btn" id="analyzePriorityBtn">
                            <i class="fas fa-exclamation-circle"></i>
                            <span>Analizar Prioridad</span>
                            <span class="ml-confidence">-</span>
                        </button>

                        <button class="ml-action-btn" id="checkDuplicateBtn">
                            <i class="fas fa-clone"></i>
                            <span>Detectar Duplicados</span>
                            <span class="ml-confidence">-</span>
                        </button>

                        <button class="ml-action-btn" id="predictSLABtn">
                            <i class="fas fa-clock"></i>
                            <span>Predecir SLA Breach</span>
                            <span class="ml-confidence">-</span>
                        </button>

                        <button class="ml-action-btn" id="suggestAssigneeBtn">
                            <i class="fas fa-user-tag"></i>
                            <span>Sugerir Asignado</span>
                            <span class="ml-confidence">-</span>
                        </button>

                        <button class="ml-action-btn" id="suggestLabelsBtn">
                            <i class="fas fa-tags"></i>
                            <span>Sugerir Labels</span>
                            <span class="ml-confidence">-</span>
                        </button>

                        <button class="ml-action-btn" id="predictStatusBtn">
                            <i class="fas fa-arrow-right"></i>
                            <span>Siguiente Estado</span>
                            <span class="ml-confidence">-</span>
                        </button>
                    </div>

                    <!-- ML Results -->
                    <div class="ml-results" id="mlResults">
                        <!-- Los resultados se mostrarán aquí -->
                    </div>
                </div>
            </div>

            <!-- Tab: History -->
            <div class="tab-content" id="history-tab">
                <div class="history-container">
                    <h3><i class="fas fa-history"></i> Historial de Acciones</h3>
                    <div class="history-list" id="historyList">
                        <!-- Historial de acciones ML -->
                    </div>
                </div>
            </div>
        </div>

        <!-- COLUMNA DERECHA: Ticket Details + ML Suggestions -->
        <div class="right-column">
            <!-- Ticket Header -->
            <div class="ticket-header">
                <div class="ticket-id">
                    <h2>MSM-1234</h2>
                    <span class="badge badge-open">Abierto</span>
                </div>
                <div class="ticket-actions">
                    <button class="btn-icon" title="Editar">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn-icon" title="Compartir">
                        <i class="fas fa-share"></i>
                    </button>
                    <button class="btn-icon" title="Más">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>

            <!-- ML Suggestions Banner -->
            <div class="ml-suggestions-banner" id="mlSuggestions">
                <div class="suggestion-item">
                    <i class="fas fa-lightbulb"></i>
                    <span>Cargando sugerencias ML...</span>
                </div>
            </div>

            <!-- Ticket Content -->
            <div class="ticket-content">
                <!-- Summary -->
                <div class="ticket-section">
                    <label class="section-label">Resumen</label>
                    <div class="editable-field" id="ticketSummary">
                        Error en API de autenticación
                    </div>
                    <div class="ml-suggestion-inline">
                        <i class="fas fa-robot"></i>
                        <span>Sugerencia ML: Agregar más contexto sobre el error</span>
                    </div>
                </div>

                <!-- Description -->
                <div class="ticket-section">
                    <label class="section-label">Descripción</label>
                    <div class="editable-field multiline" id="ticketDescription">
                        Los usuarios no pueden hacer login desde la aplicación móvil. 
                        El error aparece al intentar autenticarse con credenciales válidas.
                    </div>
                </div>

                <!-- Metadata Grid -->
                <div class="metadata-grid">
                    <!-- Priority -->
                    <div class="metadata-item">
                        <label>Prioridad</label>
                        <select class="select-field" id="prioritySelect">
                            <option value="Low">Low</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                        <div class="ml-badge" data-confidence="99">
                            <i class="fas fa-brain"></i> 99% ML
                        </div>
                    </div>

                    <!-- Assignee -->
                    <div class="metadata-item">
                        <label>Asignado</label>
                        <select class="select-field" id="assigneeSelect">
                            <option value="">Sin asignar</option>
                            <option value="carlos.quintero" selected>Carlos Quintero</option>
                            <option value="adrian.villegas">Adrian Villegas</option>
                        </select>
                        <div class="ml-badge" data-confidence="45">
                            <i class="fas fa-brain"></i> 45% ML
                        </div>
                    </div>

                    <!-- Status -->
                    <div class="metadata-item">
                        <label>Estado</label>
                        <select class="select-field" id="statusSelect">
                            <option value="Open" selected>Abierto</option>
                            <option value="In Progress">En Progreso</option>
                            <option value="Closed">Cerrado</option>
                        </select>
                        <div class="ml-badge" data-confidence="94">
                            <i class="fas fa-brain"></i> 94% ML
                        </div>
                    </div>

                    <!-- Labels -->
                    <div class="metadata-item">
                        <label>Labels</label>
                        <div class="labels-container" id="labelsContainer">
                            <span class="label-tag">backend <i class="fas fa-times"></i></span>
                            <span class="label-tag ml-suggested">api <i class="fas fa-brain"></i></span>
                            <span class="label-tag ml-suggested">auth <i class="fas fa-brain"></i></span>
                        </div>
                    </div>

                    <!-- SLA Warning -->
                    <div class="metadata-item full-width">
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle"></i>
                            <strong>Alto riesgo de violación de SLA</strong>
                            <p>Probabilidad: 71% - Nivel de riesgo: HIGH</p>
                        </div>
                    </div>
                </div>

                <!-- Comments -->
                <div class="ticket-section">
                    <div class="section-header">
                        <label class="section-label">Comentarios</label>
                        <button class="btn-secondary btn-sm" id="addCommentBtn">
                            <i class="fas fa-plus"></i> Agregar
                        </button>
                    </div>
                    
                    <div class="comments-list" id="commentsList">
                        <div class="comment">
                            <div class="comment-header">
                                <strong>Carlos Quintero</strong>
                                <span class="comment-time">Hace 2 horas</span>
                            </div>
                            <div class="comment-body">
                                Estoy investigando el issue. Parece ser un problema con el token de autenticación.
                            </div>
                        </div>
                    </div>

                    <div class="comment-input-wrapper">
                        <textarea 
                            id="commentInput" 
                            placeholder="Escribe un comentario..."
                            rows="3"
                        ></textarea>
                        <div class="comment-actions">
                            <button class="btn-link" id="suggestCommentBtn">
                                <i class="fas fa-brain"></i> Sugerir con IA
                            </button>
                            <button class="btn-primary btn-sm" id="postCommentBtn">
                                Publicar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer con estadísticas -->
    <footer class="footer">
        <div class="footer-stats">
            <div class="stat">
                <i class="fas fa-bolt"></i>
                <span>ML Service: <strong id="mlServiceStatus">Conectado</strong></span>
            </div>
            <div class="stat">
                <i class="fas fa-clock"></i>
                <span>Latencia: <strong id="mlLatency">-</strong>ms</span>
            </div>
            <div class="stat">
                <i class="fas fa-chart-line"></i>
                <span>Predicciones: <strong id="predictionsCount">0</strong></span>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="ml_client.js"></script>
    <script src="app.js"></script>
</body>
</html>
